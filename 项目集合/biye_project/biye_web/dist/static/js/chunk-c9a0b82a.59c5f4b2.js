(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9a0b82a"],{"039c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"toolWrapper"},[r("button",{staticClass:"btn btnAdd",on:{click:function(t){e.addFormStatus=!0}}},[e._v("新增")]),r("button",{staticClass:"btn btnDel",on:{click:e.handleMulDel}},[e._v("批量删除")])]),r("el-row",{staticClass:"tableWrapper"},[r("el-table",{staticClass:"tableBox",staticStyle:{width:"100%",border:"solid 1px #d7dce3"},attrs:{data:e.tableData,"header-row-class-name":"_specialtableHeader","header-cell-class-name":"_specialtableHeaderCell","header-cell-style":{height:"36px !important"},"row-class-name":"_specialtableRow","cell-class-name":"_specialtableCell",stripe:"",border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{width:"94",align:"center",type:"selection",selectable:e.checkboxT}}),r("el-table-column",{attrs:{label:"用户id",align:"center",width:"100",prop:"id"}}),r("el-table-column",{attrs:{label:"用户名",prop:"username",align:"center","min-width":"247"}}),r("el-table-column",{attrs:{label:"角色",prop:"role",align:"center","min-width":"277"}}),r("el-table-column",{attrs:{label:"密码",align:"center","min-width":"204",prop:"password"}}),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"123"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[t.row.id>1?r("i",{staticClass:"el-icon-edit-outline iconEdit",on:{click:function(r){return e.handleEdit(t.row)}}}):e._e()]),r("span",["admin"!==t.row.role?r("i",{staticClass:"el-icon-delete iconDel",on:{click:function(r){return e.handleDel(t.row)}}}):e._e()])]}}])})],1)],1),r("el-dialog",{staticClass:"myDialogForm",attrs:{title:"新增用户",visible:e.addFormStatus,width:"600"},on:{"update:visible":function(t){e.addFormStatus=t},close:e.cancelAddForm}},[r("el-form",{ref:"addruleForm",attrs:{model:e.addForm,rules:e.addRules,"label-width":"150px",size:"mini"}},[r("el-form-item",{attrs:{label:"角色",prop:"role"}},[r("el-input",{staticClass:"dialogItem",model:{value:e.addForm.role,callback:function(t){e.$set(e.addForm,"role",t)},expression:"addForm.role"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{staticClass:"dialogItem",model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"登录密码",prop:"password",required:""}},[r("el-input",{staticClass:"dialogItem",model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelAddForm}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddForm}},[e._v("确 定")])],1)],1),r("el-dialog",{staticClass:"myDialogForm",attrs:{title:"修改用户",visible:e.editFormStatus,width:"600"},on:{"update:visible":function(t){e.editFormStatus=t},close:e.cancelEditForm}},[r("el-form",{ref:"editruleForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"150px",size:"mini"}},[r("el-form-item",{attrs:{label:"角色",prop:"role"}},[r("el-input",{staticClass:"dialogItem",model:{value:e.editForm.role,callback:function(t){e.$set(e.editForm,"role",t)},expression:"editForm.role"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{staticClass:"dialogItem",model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),r("el-form-item",{attrs:{label:"登录密码",prop:"password",required:""}},[r("el-input",{staticClass:"dialogItem",model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelEditForm}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handleEditForm}},[e._v("确 定")])],1)],1)],1)},s=[],i=(r("4160"),r("c975"),r("d81d"),r("159b"),r("96cf"),r("1da1")),l=r("5530"),n=r("2f62"),o={name:"permission",data:function(){var e=this,t={role:[{required:!0,message:"请输入角色名",trigger:"blur"},{validator:function(e,t,r){var a=["user","admin"];return-1===a.indexOf(t)&&r(new Error("角色目前只能是user或者admin")),r()},trigger:"blur"}],password:[{validator:function(e,t,r){if(""===t)r(new Error("请输入密码"));else{var a=/^(?=.*\d)(?=.*[a-z])[a-zA-Z0-9]{6,10}$/;if(!a.test(t))return r(new Error("密码(必须包含字母和数字的组合，不能使用特殊字符，长度在 6-10 之间)"));r()}},trigger:"blur"}]};return{multipleSelection:[],tableData:[],addFormStatus:!1,editFormStatus:!1,curEditUsername:"",curEidtUserId:null,editForm:{username:"",role:"",password:""},addForm:{username:"",role:"",password:""},addRules:Object(l["a"])({},t,{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:8,message:"长度在 2 到 8 个字符",trigger:"blur"},{validator:function(t,r,a){var s=e.tableData.map((function(e){return e.username}));return-1!==s.indexOf(r)&&a(new Error("用户名已存在")),a()},trigger:"change"}]}),editRules:Object(l["a"])({},t,{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:8,message:"长度在 2 到 8 个字符",trigger:"blur"},{validator:function(t,r,a){var s=e.tableData.map((function(e){return e.username}));return-1!==s.indexOf(r)&&e.curEditUsername!==r&&a(new Error("该用户名已被其他人选用")),a()},trigger:"blur"}]})}},created:function(){this.init()},methods:Object(l["a"])({},Object(n["b"])(["getAllUsers","userRegister","userEdit","userDelete","userDeletes"]),{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getAllUsers({}).then((function(t){"0"===t.code?e.tableData=t.data:e.$message.warning(t.message)}));case 1:case"end":return t.stop()}}),t)})))()},checkboxT:function(e,t){return"admin"!==e.role},handleMulDel:function(){var e=this;if(0===this.multipleSelection.length)this.$message.warning("请选择要删除的用户");else{var t=this.multipleSelection.map((function(e){return e.id}));this.userDeletes({data:{ids:t}}).then((function(t){"0"===t.code?(e.$message.success("删除成功"),e.init()):e.$message.error(t.message)}))}},handleSelectionChange:function(e){this.multipleSelection=e},handleEdit:function(e){this.editForm.username=e.username,this.editForm.role=e.role,this.editForm.password=e.password,this.curEditUsername=e.username,this.curEidtUserId=e.id,this.editFormStatus=!0},handleDel:function(e){var t=this,r=e.id;this.userDelete({data:{id:r}}).then((function(e){"0"===e.code?(t.$message.success(e.message),t.init()):t.$message.warning(e.message)}))},cancelAddForm:function(){this.$refs.addruleForm.resetFields(),this.addFormStatus=!1},handleAddForm:function(){var e=this;this.$refs.addruleForm.validate((function(t){t&&(e.userRegister({data:Object(l["a"])({},e.addForm)}).then((function(t){"0"===t.code?(e.$refs.addruleForm.resetFields(),e.init()):e.$message.warning(t.message)})),e.addFormStatus=!1)}))},cancelEditForm:function(){this.editFormStatus=!1},handleEditForm:function(){var e=this;this.$refs.editruleForm.validate((function(t){t&&e.userEdit({data:Object(l["a"])({id:e.curEidtUserId},e.editForm)}).then((function(t){"0"===t.code?(e.editFormStatus=!1,e.init()):e.$message.warning(t.message)}))}))}})},d=o,c=(r("2d88"),r("2877")),u=Object(c["a"])(d,a,s,!1,null,"3eb519f6",null);t["default"]=u.exports},"2d88":function(e,t,r){"use strict";var a=r("c5b1"),s=r.n(a);s.a},c5b1:function(e,t,r){}}]);